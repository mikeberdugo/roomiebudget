{% extends 'base/base.html' %}
{% load crispy_forms_tags %} 

{% block title %}
roomiebudget.co - Portal Empresas - Lista Activos
{% endblock %}

{% block navbar %}
    {% include 'base/nav_boards.html' %}
{% endblock %}




{% block css %}

.card-text {
    overflow: hidden;
    text-overflow: ellipsis;
    display: -webkit-box;
    -webkit-line-clamp: 3; /* Número de líneas a mostrar */
    -webkit-box-orient: vertical;
    height: calc(1.5em * 3); /* Altura según el número de líneas y el tamaño de la fuente */
}

up-modal[size=large] up-modal-box {
    border-radius: 0.75rem;
    box-shadow: 0 0.25rem 0.5rem rgba(0, 0, 0, 0.1);
    
}

up-modal[size=medium] up-modal-box {
    border-radius: 0.75rem;
    box-shadow: 0 0.25rem 0.5rem rgba(0, 0, 0, 0.1);
    
}

.select2-container .select2-selection--single .select2-selection__rendered {
    text-align: left;
}

.select2-container .select2-search--dropdown .select2-search__field {
    height: 28px; /* Ajusta la altura según prefieras */
    padding: 4px 8px; /* Ajusta el padding para hacerlo más delgado */
    font-size: 14px; /* Si quieres un texto más pequeño */
    border-radius: 8px; /* Bordes más suaves si te gusta */
}


.select2-container .select2-results__option {
    text-align: left;
}


.swal2-container {
    z-index: 9999 !important; /* Más alto que el z-index de los modales de Unpoly */
}




{% endblock %}



{% block sub_titulo1 %} 
Hogar
{% endblock %}


{% block sub_titulo2 %} 
Hogar
{% endblock %}


{% block titulo2 %} 
Lista de Hogares
{% endblock %}

{% block actions %}
    
    
    <!-- Botón adicional -->
    <a
        class='btn btn-light-info'
        up-layer='new modal'
        up-target=".modal-content"
        up-size = "medium"
        up-align = "center"
        up-backdrop = "true"
        up-history = "false"
        up-dismissable ="false"
        up-cache="false"
        href="{% url 'apartment:apartment_home_add' %}" 
        
        >
        <i class="fa-solid fa-square-plus fs-3"></i>
        Agregar Hogar
    </a>




{% endblock %}


{% block content %}

<div class="container">
    <div class="row">
        {% for apartment in apartments %}
            <div class="col-md-4 mb-10"> <!-- 4 columnas por fila = máximo 3 cards -->
                <div class="card shadow-sm">
                    <div class="card-header">
                        <h3 class="card-title">{{ apartment.name }}</h3>
                        <div class="card-toolbar">
                            <!--begin::Menu wrapper-->
                                <div class="m-0">
                                    <!--begin::Menu toggle-->
                                    <button type="button" class="btn btn-icon btn-light-linkedin me-5" data-kt-menu-trigger="click" data-kt-menu-placement="bottom-start" data-kt-menu-offset="0,5">
                                        <i class="ki-duotone ki-down fs-3 rotate-180"></i>
                                    </button>
                                    <!--end::Menu toggle-->

                                    <!--begin::Menu dropdown-->
                                    <div class="menu menu-sub menu-sub-dropdown w-250px w-md-300px" data-kt-menu="true" id="kt_menu_select2">
                                            <p> 
                                                habla
                                            </p>

                                    </div>
                                    <!--end::Menu dropdown-->
                                </div>
                                <!--end::Menu wrapper-->

                        </div>
                    </div>
                    <div class="card-body">
                        Lorem Ipsum is simply dummy text...
                    </div>
                    <div class="card-footer">
                        <a href="{% url 'apartment:apartment_view' apartment.id %}" class="btn btn-light-linkedin">
                            <i class="fa-solid fa-eye"></i>
                            Ver 
                        </a>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>
</div>







{% endblock %}


{% block js %}
<script>
    document.addEventListener('up:fragment:inserted', function(event) {
        const modalContent = up.layer.current.element;

        if (modalContent) {
            const selectElements = modalContent.querySelectorAll('[data-control="select2"]');
            
            // Usamos un pequeño retraso para asegurar el renderizado completo
            setTimeout(() => {
                selectElements.forEach((select, index) => {
                    // Aseguramos un ID único si no tiene uno
                    if (!select.id) {
                        select.id = `select2-unique-${Date.now()}-${index}`;
                    }

                    if (!$(select).data('select2')) {
                        $(select).select2({
                            dropdownParent: $(modalContent),
                            width: '100%',
                            minimumResultsForSearch: Infinity
                        });
                    }
                });
            }, 300); // Aumentamos un poco el tiempo para mayor seguridad
        } else {
            console.log('Contenido completo del fragmento:', event.target.innerHTML);
        }
    });
</script>
{% endblock %}